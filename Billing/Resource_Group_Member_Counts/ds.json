{
    "LMApiVersion": "3",
    "appliesTo": "billing_api.id && billing_api.pass && billing_api.account",
    "auditVersion": 0,
    "autoDiscoveryConfig": {
        "deleteInactiveInstance": false,
        "disableInstance": false,
        "filters": [
            {
                "attribute": "auto.fullPath",
                "comment": "",
                "operation": "RegexNotMatch",
                "value": "type|Minimal|My Devices"
            },
            {
                "attribute": "auto.groupType",
                "comment": "",
                "operation": "Equal",
                "value": "Normal"
            },
            {
                "attribute": "auto.depth",
                "comment": "",
                "operation": "LessEqual",
                "value": "2"
            }
        ],
        "instanceAutoGroupMethod": "none",
        "instanceAutoGroupMethodParams": "",
        "method": {
            "groovyScript": "ad",
            "linuxCmdline": null,
            "linuxScript": null,
            "name": "ad_script",
            "type": "embeded",
            "winCmdline": null,
            "winScript": null
        },
        "persistentInstance": false,
        "scheduleInterval": 15
    },
    "checksum": "8cf7843c840b79910a6a3e9434fa238c",
    "collectInterval": 60,
    "collectMethod": "batchscript",
    "collectorAttribute": {
        "groovyScript": "collect",
        "linuxCmdline": "",
        "linuxScript": "",
        "name": "batchscript",
        "scriptType": "embed",
        "windowsCmdline": "",
        "windowsScript": ""
    },
    "coretools_format": "ds meV1",
    "dataPoints": [
        {
            "alertBody": "",
            "alertClearTransitionInterval": 0,
            "alertExpr": "",
            "alertExprNote": "",
            "alertForNoData": 1,
            "alertSubject": "",
            "alertTransitionInterval": 0,
            "dataType": 7,
            "description": "",
            "enableAnomalyAlertSuppression": "",
            "maxDigits": 4,
            "maxValue": "",
            "minValue": "",
            "name": "Total_Cost",
            "postProcessorMethod": "expression",
            "postProcessorParam": "aws_total_cost + azure_total_cost + gcp_total_cost + host_total_cost",
            "rawDataFieldName": "",
            "type": 2,
            "userParam1": "",
            "userParam2": "",
            "userParam3": ""
        },
        {
            "alertBody": "",
            "alertClearTransitionInterval": 0,
            "alertExpr": "",
            "alertExprNote": "",
            "alertForNoData": 1,
            "alertSubject": "",
            "alertTransitionInterval": 0,
            "dataType": 7,
            "description": "Count of all descendants under the group.",
            "enableAnomalyAlertSuppression": "",
            "maxDigits": 4,
            "maxValue": "",
            "minValue": "",
            "name": "Total_Count",
            "postProcessorMethod": "namevalue",
            "postProcessorParam": "##WILDVALUE##.numOfHosts",
            "rawDataFieldName": "output",
            "type": 2,
            "userParam1": "",
            "userParam2": "",
            "userParam3": ""
        },
        {
            "alertBody": "",
            "alertClearTransitionInterval": 0,
            "alertExpr": "",
            "alertExprNote": "",
            "alertForNoData": 1,
            "alertSubject": "",
            "alertTransitionInterval": 0,
            "dataType": 7,
            "description": "Total count of all AWS descendant instances.",
            "enableAnomalyAlertSuppression": "",
            "maxDigits": 4,
            "maxValue": "",
            "minValue": "",
            "name": "aws_count",
            "postProcessorMethod": "namevalue",
            "postProcessorParam": "##WILDVALUE##.numOfAWSDevices",
            "rawDataFieldName": "output",
            "type": 2,
            "userParam1": "",
            "userParam2": "",
            "userParam3": ""
        },
        {
            "alertBody": "",
            "alertClearTransitionInterval": 0,
            "alertExpr": "",
            "alertExprNote": "",
            "alertForNoData": 1,
            "alertSubject": "",
            "alertTransitionInterval": 0,
            "dataType": 7,
            "description": "",
            "enableAnomalyAlertSuppression": "",
            "maxDigits": 4,
            "maxValue": "",
            "minValue": "",
            "name": "aws_total_cost",
            "postProcessorMethod": "expression",
            "postProcessorParam": "aws_count * if(un(aws_unit_cost),0,aws_unit_cost)",
            "rawDataFieldName": "",
            "type": 2,
            "userParam1": "",
            "userParam2": "",
            "userParam3": ""
        },
        {
            "alertBody": "",
            "alertClearTransitionInterval": 0,
            "alertExpr": "",
            "alertExprNote": "",
            "alertForNoData": 1,
            "alertSubject": "",
            "alertTransitionInterval": 0,
            "dataType": 7,
            "description": "",
            "enableAnomalyAlertSuppression": "",
            "maxDigits": 4,
            "maxValue": "",
            "minValue": "",
            "name": "aws_unit_cost",
            "postProcessorMethod": "expression",
            "postProcessorParam": "##billing_api.aws_cost##",
            "rawDataFieldName": "",
            "type": 2,
            "userParam1": "",
            "userParam2": "",
            "userParam3": ""
        },
        {
            "alertBody": "",
            "alertClearTransitionInterval": 0,
            "alertExpr": "",
            "alertExprNote": "",
            "alertForNoData": 1,
            "alertSubject": "",
            "alertTransitionInterval": 0,
            "dataType": 7,
            "description": "",
            "enableAnomalyAlertSuppression": "",
            "maxDigits": 4,
            "maxValue": "",
            "minValue": "",
            "name": "aws_unit_cost_display",
            "postProcessorMethod": "expression",
            "postProcessorParam": "if(un(aws_unit_cost),0,aws_unit_cost)",
            "rawDataFieldName": "",
            "type": 2,
            "userParam1": "",
            "userParam2": "",
            "userParam3": ""
        },
        {
            "alertBody": "",
            "alertClearTransitionInterval": 0,
            "alertExpr": "",
            "alertExprNote": "",
            "alertForNoData": 1,
            "alertSubject": "",
            "alertTransitionInterval": 0,
            "dataType": 7,
            "description": "",
            "enableAnomalyAlertSuppression": "",
            "maxDigits": 4,
            "maxValue": "",
            "minValue": "",
            "name": "azure_count",
            "postProcessorMethod": "namevalue",
            "postProcessorParam": "##WILDVALUE##.numOfAzureDevices",
            "rawDataFieldName": "output",
            "type": 2,
            "userParam1": "",
            "userParam2": "",
            "userParam3": ""
        },
        {
            "alertBody": "",
            "alertClearTransitionInterval": 0,
            "alertExpr": "",
            "alertExprNote": "",
            "alertForNoData": 1,
            "alertSubject": "",
            "alertTransitionInterval": 0,
            "dataType": 7,
            "description": "",
            "enableAnomalyAlertSuppression": "",
            "maxDigits": 4,
            "maxValue": "",
            "minValue": "",
            "name": "azure_total_cost",
            "postProcessorMethod": "expression",
            "postProcessorParam": "azure_count * if(un(azure_unit_cost),0,azure_unit_cost)",
            "rawDataFieldName": "",
            "type": 2,
            "userParam1": "",
            "userParam2": "",
            "userParam3": ""
        },
        {
            "alertBody": "",
            "alertClearTransitionInterval": 0,
            "alertExpr": "",
            "alertExprNote": "",
            "alertForNoData": 1,
            "alertSubject": "",
            "alertTransitionInterval": 0,
            "dataType": 7,
            "description": "",
            "enableAnomalyAlertSuppression": "",
            "maxDigits": 4,
            "maxValue": "",
            "minValue": "",
            "name": "azure_unit_cost",
            "postProcessorMethod": "expression",
            "postProcessorParam": "##billing_api.azure_cost##",
            "rawDataFieldName": "",
            "type": 2,
            "userParam1": "",
            "userParam2": "",
            "userParam3": ""
        },
        {
            "alertBody": "",
            "alertClearTransitionInterval": 0,
            "alertExpr": "",
            "alertExprNote": "",
            "alertForNoData": 1,
            "alertSubject": "",
            "alertTransitionInterval": 0,
            "dataType": 7,
            "description": "",
            "enableAnomalyAlertSuppression": "",
            "maxDigits": 4,
            "maxValue": "",
            "minValue": "",
            "name": "azure_unit_cost_display",
            "postProcessorMethod": "expression",
            "postProcessorParam": "if(un(azure_unit_cost),0,azure_unit_cost)",
            "rawDataFieldName": "",
            "type": 2,
            "userParam1": "",
            "userParam2": "",
            "userParam3": ""
        },
        {
            "alertBody": "",
            "alertClearTransitionInterval": 0,
            "alertExpr": "",
            "alertExprNote": "",
            "alertForNoData": 1,
            "alertSubject": "",
            "alertTransitionInterval": 0,
            "dataType": 4,
            "description": "Measures the amount of time spent fetching data from the LM API.",
            "enableAnomalyAlertSuppression": "",
            "maxDigits": 4,
            "maxValue": "",
            "minValue": "",
            "name": "collection_time",
            "postProcessorMethod": "none",
            "postProcessorParam": "",
            "rawDataFieldName": "responseTime",
            "type": 2,
            "userParam1": "",
            "userParam2": "",
            "userParam3": ""
        },
        {
            "alertBody": "",
            "alertClearTransitionInterval": 0,
            "alertExpr": "",
            "alertExprNote": "",
            "alertForNoData": 1,
            "alertSubject": "",
            "alertTransitionInterval": 0,
            "dataType": 7,
            "description": "",
            "enableAnomalyAlertSuppression": "",
            "maxDigits": 4,
            "maxValue": "",
            "minValue": "",
            "name": "gcp_cost_display",
            "postProcessorMethod": "expression",
            "postProcessorParam": "if(un(gcp_unit_cost),0,gcp_unit_cost)",
            "rawDataFieldName": "",
            "type": 2,
            "userParam1": "",
            "userParam2": "",
            "userParam3": ""
        },
        {
            "alertBody": "",
            "alertClearTransitionInterval": 0,
            "alertExpr": "",
            "alertExprNote": "",
            "alertForNoData": 1,
            "alertSubject": "",
            "alertTransitionInterval": 0,
            "dataType": 7,
            "description": "",
            "enableAnomalyAlertSuppression": "",
            "maxDigits": 4,
            "maxValue": "",
            "minValue": "",
            "name": "gcp_count",
            "postProcessorMethod": "namevalue",
            "postProcessorParam": "##WILDVALUE##.numOfGcpDevices",
            "rawDataFieldName": "output",
            "type": 2,
            "userParam1": "",
            "userParam2": "",
            "userParam3": ""
        },
        {
            "alertBody": "",
            "alertClearTransitionInterval": 0,
            "alertExpr": "",
            "alertExprNote": "",
            "alertForNoData": 1,
            "alertSubject": "",
            "alertTransitionInterval": 0,
            "dataType": 7,
            "description": "",
            "enableAnomalyAlertSuppression": "",
            "maxDigits": 4,
            "maxValue": "",
            "minValue": "",
            "name": "gcp_total_cost",
            "postProcessorMethod": "expression",
            "postProcessorParam": "gcp_count * if(un(gcp_unit_cost),0,gcp_unit_cost)",
            "rawDataFieldName": "",
            "type": 2,
            "userParam1": "",
            "userParam2": "",
            "userParam3": ""
        },
        {
            "alertBody": "",
            "alertClearTransitionInterval": 0,
            "alertExpr": "",
            "alertExprNote": "",
            "alertForNoData": 1,
            "alertSubject": "",
            "alertTransitionInterval": 0,
            "dataType": 7,
            "description": "",
            "enableAnomalyAlertSuppression": "",
            "maxDigits": 4,
            "maxValue": "",
            "minValue": "",
            "name": "gcp_unit_cost",
            "postProcessorMethod": "expression",
            "postProcessorParam": "##billing_api.gcp_cost##",
            "rawDataFieldName": "",
            "type": 2,
            "userParam1": "",
            "userParam2": "",
            "userParam3": ""
        },
        {
            "alertBody": "",
            "alertClearTransitionInterval": 0,
            "alertExpr": "",
            "alertExprNote": "",
            "alertForNoData": 1,
            "alertSubject": "",
            "alertTransitionInterval": 0,
            "dataType": 7,
            "description": "",
            "enableAnomalyAlertSuppression": "",
            "maxDigits": 4,
            "maxValue": "",
            "minValue": "",
            "name": "host_cost_display",
            "postProcessorMethod": "expression",
            "postProcessorParam": "if(un(host_unit_cost),0,host_unit_cost)",
            "rawDataFieldName": "",
            "type": 2,
            "userParam1": "",
            "userParam2": "",
            "userParam3": ""
        },
        {
            "alertBody": "",
            "alertClearTransitionInterval": 0,
            "alertExpr": "",
            "alertExprNote": "",
            "alertForNoData": 1,
            "alertSubject": "",
            "alertTransitionInterval": 0,
            "dataType": 7,
            "description": "",
            "enableAnomalyAlertSuppression": "",
            "maxDigits": 4,
            "maxValue": "",
            "minValue": "",
            "name": "host_count",
            "postProcessorMethod": "expression",
            "postProcessorParam": "Total_Count - aws_count - azure_count - gcp_count",
            "rawDataFieldName": "",
            "type": 2,
            "userParam1": "",
            "userParam2": "",
            "userParam3": ""
        },
        {
            "alertBody": "",
            "alertClearTransitionInterval": 0,
            "alertExpr": "",
            "alertExprNote": "",
            "alertForNoData": 1,
            "alertSubject": "",
            "alertTransitionInterval": 0,
            "dataType": 7,
            "description": "",
            "enableAnomalyAlertSuppression": "",
            "maxDigits": 4,
            "maxValue": "",
            "minValue": "",
            "name": "host_total_cost",
            "postProcessorMethod": "expression",
            "postProcessorParam": "host_count * if(un(host_unit_cost),0,host_unit_cost)",
            "rawDataFieldName": "",
            "type": 2,
            "userParam1": "",
            "userParam2": "",
            "userParam3": ""
        },
        {
            "alertBody": "",
            "alertClearTransitionInterval": 0,
            "alertExpr": "",
            "alertExprNote": "",
            "alertForNoData": 1,
            "alertSubject": "",
            "alertTransitionInterval": 0,
            "dataType": 7,
            "description": "",
            "enableAnomalyAlertSuppression": "",
            "maxDigits": 4,
            "maxValue": "",
            "minValue": "",
            "name": "host_unit_cost",
            "postProcessorMethod": "expression",
            "postProcessorParam": "##billing_api.resource_cost##",
            "rawDataFieldName": "",
            "type": 2,
            "userParam1": "",
            "userParam2": "",
            "userParam3": ""
        }
    ],
    "description": "Gives group level count statistics: number of hosts, number of cloud resources, etc.",
    "displayName": "Resource Group Member Counts",
    "enableAutoDiscovery": true,
    "enableEriDiscovery": false,
    "eriDiscoveryConfig": null,
    "eriDiscoveryInterval": -1,
    "graphs": [
        {
            "base1024": false,
            "dataPoints": [
                {
                    "consolidateFunc": 1,
                    "dpName": "Total_Cost",
                    "name": "Total_Count"
                },
                {
                    "consolidateFunc": 1,
                    "dpName": "aws_total_cost",
                    "name": "numOfAWSDevices"
                },
                {
                    "consolidateFunc": 1,
                    "dpName": "azure_total_cost",
                    "name": "numOfAzureDevices"
                },
                {
                    "consolidateFunc": 1,
                    "dpName": "gcp_total_cost",
                    "name": "numOfGcpDevices"
                },
                {
                    "consolidateFunc": 1,
                    "dpName": "host_total_cost",
                    "name": "numOfHosts"
                }
            ],
            "displayPrio": 1,
            "height": 120,
            "lines": [
                {
                    "colorName": "red",
                    "dataPointName": "Total_Count",
                    "isVirtualDataPoint": false,
                    "legend": "Total Cost",
                    "type": 1
                },
                {
                    "colorName": "blue",
                    "dataPointName": "numOfAWSDevices",
                    "isVirtualDataPoint": false,
                    "legend": "AWS Cost",
                    "type": 3
                },
                {
                    "colorName": "olive",
                    "dataPointName": "numOfAzureDevices",
                    "isVirtualDataPoint": false,
                    "legend": "Azure Cost",
                    "type": 3
                },
                {
                    "colorName": "fuchsia",
                    "dataPointName": "numOfGcpDevices",
                    "isVirtualDataPoint": false,
                    "legend": "GCP Cost",
                    "type": 3
                },
                {
                    "colorName": "silver",
                    "dataPointName": "numOfHosts",
                    "isVirtualDataPoint": false,
                    "legend": "Resource Cost",
                    "type": 3
                }
            ],
            "maxValue": "NaN",
            "minValue": 0.0,
            "name": "Device Cost",
            "rigid": false,
            "timeScale": "1month",
            "title": "Device Cost",
            "verticalLabel": "$",
            "virtualDataPoints": [],
            "width": 360
        },
        {
            "base1024": false,
            "dataPoints": [
                {
                    "consolidateFunc": 1,
                    "dpName": "Total_Count",
                    "name": "total_count"
                },
                {
                    "consolidateFunc": 1,
                    "dpName": "aws_count",
                    "name": "aws_count"
                },
                {
                    "consolidateFunc": 1,
                    "dpName": "azure_count",
                    "name": "azure_count"
                },
                {
                    "consolidateFunc": 1,
                    "dpName": "gcp_count",
                    "name": "gcp_count"
                },
                {
                    "consolidateFunc": 1,
                    "dpName": "host_count",
                    "name": "host_count"
                }
            ],
            "displayPrio": 1,
            "height": 120,
            "lines": [
                {
                    "colorName": "blue",
                    "dataPointName": "aws_count",
                    "isVirtualDataPoint": false,
                    "legend": "AWS",
                    "type": 3
                },
                {
                    "colorName": "olive",
                    "dataPointName": "azure_count",
                    "isVirtualDataPoint": false,
                    "legend": "Azure",
                    "type": 3
                },
                {
                    "colorName": "fuchsia",
                    "dataPointName": "gcp_count",
                    "isVirtualDataPoint": false,
                    "legend": "GCP",
                    "type": 3
                },
                {
                    "colorName": "silver",
                    "dataPointName": "host_count",
                    "isVirtualDataPoint": false,
                    "legend": "Resources",
                    "type": 3
                },
                {
                    "colorName": "red",
                    "dataPointName": "total_count",
                    "isVirtualDataPoint": false,
                    "legend": "Total",
                    "type": 1
                }
            ],
            "maxValue": "NaN",
            "minValue": 0.0,
            "name": "Device Count (All descendants)",
            "rigid": false,
            "timeScale": "1month",
            "title": "Device Count (All descendants)",
            "verticalLabel": "count",
            "virtualDataPoints": [],
            "width": 360
        }
    ],
    "group": "_WeenigWare Billing",
    "hasMultiInstances": true,
    "lineageId": "6zDuWlhpQ9mACeDUx9LTcw",
    "name": "Resource_Group_Member_Counts",
    "overviewgraphs": [],
    "tags": "",
    "technology": "Set Auto Discovery filter \"auto.depth <= 1\" to determine which group levels are included. Auto.depth represents the number of levels below the root the group resides.\nTo calculate valid costs, set billing_api.[aws|azure|gcp|resource]_cost properties on the collector where the billing api id, pass, and account are defined or on the instances themselves (if you wanted a different value per instance).\nSupporting documentation can be found at https://stuart.weenig.com/2019/11/counting-resources-per-group.html"
}