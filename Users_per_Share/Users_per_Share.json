{
  "id" : 361288,
  "description" : "",
  "group" : "z_In Development",
  "appliesTo" : "isWindows()",
  "technology" : "",
  "tags" : "",
  "checksum" : "a3ba65479367c414cad211eac28a3cde",
  "lineageId" : "xhmegerKRB-mM3X4dqWy1A",
  "name" : "Users_per_Share",
  "displayName" : "Users per Share",
  "version" : 1585933174,
  "auditVersion" : 0,
  "hasMultiInstances" : true,
  "collectInterval" : 60,
  "collectMethod" : "batchscript",
  "collectorAttribute" : {
    "name" : "batchscript",
    "linuxCmdline" : "",
    "linuxScript" : "",
    "groovyScript" : "import com.santaba.agent.groovyapi.expect.Expect;\nimport com.santaba.agent.groovyapi.snmp.Snmp;\nimport com.santaba.agent.groovyapi.http.*;\nimport com.santaba.agent.groovyapi.jmx.*;\nimport org.xbill.DNS.*;/*******************************************************************************\n *  Â© 2007-2019 - LogicMonitor, Inc. All rights reserved.\n ******************************************************************************/\n\nimport com.santaba.agent.groovyapi.win32.WMI\n\ndef hostname = hostProps.get(\"system.hostname\");\n\ntry {\n  def namespace = \"CIMv2\";\n  def timeout = 30;\n  def wmi_query = 'select * from win32_serverconnection';\n\n  def wmi_output_all = WMI.queryAll(hostname, namespace, wmi_query, timeout);\n\n  def shareCounts = [:]\n\n  wmi_output_all.each {\n    if (shareCounts.containsKey(it[\"SHARENAME\"])) {\n      shareCounts[it[\"SHARENAME\"]] += it[\"NUMBEROFUSERS\"].toInteger()\n    } else {\n      shareCounts[it[\"SHARENAME\"]] = it[\"NUMBEROFUSERS\"].toInteger()\n    }\n  }\n\nshareCounts.each{k,v ->\n  println(\"${k}.numofusers: ${v}\")\n}\n\n  return 0;\n} catch (Exception e) {println e;return 1}",
    "scriptType" : "embed",
    "windowsCmdline" : "",
    "windowsScript" : ""
  },
  "enableAutoDiscovery" : true,
  "autoDiscoveryConfig" : {
    "persistentInstance" : false,
    "disableInstance" : false,
    "deleteInactiveInstance" : true,
    "instanceAutoGroupMethod" : "none",
    "instanceAutoGroupMethodParams" : "",
    "scheduleInterval" : 0,
    "method" : {
      "name" : "ad_wmi",
      "wmiClass" : "Win32_Share",
      "property" : "Name",
      "namespace" : "CIMv2",
      "enableWmiClassILP" : true,
      "ILP" : [ {
        "wmiName" : "path",
        "lmName" : "auto.path"
      }, {
        "wmiName" : "type",
        "lmName" : "auto.type"
      } ],
      "enableLinkedClassILP" : false,
      "linkedClasses" : [ ],
      "externalResourceID" : "",
      "externalResourceType" : ""
    },
    "filters" : [ {
      "attribute" : "name",
      "operation" : "NotContain",
      "value" : "$",
      "comment" : "Exclude Hidden Shares"
    } ]
  },
  "dataPoints" : [ {
    "id" : 16651,
    "dataSourceId" : 361288,
    "name" : "ConnectedUsers_raw",
    "description" : "",
    "alertTransitionInterval" : 0,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "namevalue",
    "postProcessorParam" : "##WILDVALUE##.numofusers",
    "rawDataFieldName" : "output",
    "maxValue" : "",
    "minValue" : "",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  }, {
    "id" : 16652,
    "dataSourceId" : 361288,
    "name" : "ConnectedUsers",
    "description" : "",
    "alertTransitionInterval" : 0,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "expression",
    "postProcessorParam" : "if(un(ConnectedUsers_raw),0,ConnectedUsers_raw)",
    "rawDataFieldName" : "",
    "maxValue" : "",
    "minValue" : "",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  } ],
  "enableEriDiscovery" : false,
  "eriDiscoveryInterval" : -1,
  "eriDiscoveryConfig" : null
}