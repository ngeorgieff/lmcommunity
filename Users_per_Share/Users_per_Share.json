{
  "id" : 13304244,
  "description" : "",
  "group" : "_WeenigWare",
  "appliesTo" : "isWindows()",
  "technology" : "",
  "tags" : "",
  "checksum" : "95ecc824d9883ce31f319926580e3bc6",
  "lineageId" : "eKOsQYp1T7muWK48eSkaHA",
  "name" : "Users_per_Share",
  "displayName" : "Users per Share",
  "version" : 1586294984,
  "auditVersion" : 0,
  "hasMultiInstances" : true,
  "collectInterval" : 60,
  "collectMethod" : "batchscript",
  "collectorAttribute" : {
    "name" : "batchscript",
    "linuxCmdline" : "",
    "linuxScript" : "",
    "groovyScript" : "import com.santaba.agent.groovyapi.win32.WMI\n\ndef hostname = hostProps.get(\"system.hostname\")\n\ntry {\n  def namespace = \"CIMv2\";\n  def timeout = 30;\n  def wmi_query = 'select * from win32_serverconnection';\n  def wmi_output_all = WMI.queryAll(hostname, namespace, wmi_query, timeout);\n  def shareCounts = [:]\n  wmi_output_all.each {\n    if (shareCounts.containsKey(it[\"SHARENAME\"])) {\n      shareCounts[it[\"SHARENAME\"]] += it[\"NUMBEROFUSERS\"].toInteger()\n    } else {\n      shareCounts[it[\"SHARENAME\"]] = it[\"NUMBEROFUSERS\"].toInteger()\n    }\n  }\n\nshareCounts.each{k,v -> println(\"${k}.numofusers: ${v}\")}\n\nreturn 0\n} catch (Exception e) {println e;return 1}",
    "scriptType" : "embed",
    "windowsCmdline" : "",
    "windowsScript" : ""
  },
  "enableAutoDiscovery" : true,
  "autoDiscoveryConfig" : {
    "persistentInstance" : false,
    "disableInstance" : false,
    "deleteInactiveInstance" : true,
    "instanceAutoGroupMethod" : "none",
    "instanceAutoGroupMethodParams" : "",
    "scheduleInterval" : 0,
    "method" : {
      "name" : "ad_wmi",
      "wmiClass" : "Win32_Share",
      "property" : "Name",
      "namespace" : "CIMv2",
      "enableWmiClassILP" : true,
      "ILP" : [ {
        "wmiName" : "path",
        "lmName" : "auto.path"
      }, {
        "wmiName" : "type",
        "lmName" : "auto.type"
      } ],
      "enableLinkedClassILP" : false,
      "linkedClasses" : [ ],
      "externalResourceID" : "",
      "externalResourceType" : ""
    },
    "filters" : [ {
      "attribute" : "name",
      "operation" : "NotContain",
      "value" : "$",
      "comment" : "Exclude Hidden Shares"
    } ]
  },
  "dataPoints" : [ {
    "id" : 17692,
    "dataSourceId" : 13304244,
    "name" : "ConnectedUsers",
    "description" : "",
    "alertTransitionInterval" : 0,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "expression",
    "postProcessorParam" : "if(un(ConnectedUsers_raw),0,ConnectedUsers_raw)",
    "rawDataFieldName" : "",
    "maxValue" : "",
    "minValue" : "",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  }, {
    "id" : 17693,
    "dataSourceId" : 13304244,
    "name" : "ConnectedUsers_raw",
    "description" : "",
    "alertTransitionInterval" : 0,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "namevalue",
    "postProcessorParam" : "##WILDVALUE##.numofusers",
    "rawDataFieldName" : "output",
    "maxValue" : "",
    "minValue" : "",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  } ],
  "enableEriDiscovery" : false,
  "eriDiscoveryInterval" : -1,
  "eriDiscoveryConfig" : null
}