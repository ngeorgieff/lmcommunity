{
  "id" : 11476338,
  "description" : "Counts the number of ports that are administratively up, and that are administratively down. Also counts the number of ports that are operationally up, and that are operationally down.",
  "group" : "_WeenigWare",
  "appliesTo" : "hasCategory(\"snmp\")",
  "technology" : "Written by Stuart Weenig",
  "tags" : "",
  "checksum" : "b7f70cf3f27103e41c111adc7807a1fb",
  "lineageId" : "tGZ85LNtS865MeYmujRCCA",
  "name" : "Interface_Status_Count",
  "displayName" : "Port Capacity",
  "version" : 1582223485,
  "auditVersion" : 0,
  "hasMultiInstances" : false,
  "collectInterval" : 60,
  "collectMethod" : "script",
  "collectorAttribute" : {
    "name" : "script",
    "linuxCmdline" : "",
    "linuxScript" : "",
    "groovyScript" : "/*******************************************************************************\n *  Â© 2007-2019 - LogicMonitor, Inc. All rights reserved.\n ******************************************************************************/\nOid = \"1.3.6.1.2.1.2.2.1\" //polling the interfaces table (returns \"metricOID.wildvalue = datavalue\")\nwildvalueTerms = 1\n\nimport com.santaba.agent.groovyapi.snmp.Snmp\n\ndef host = hostProps.get('system.hostname')\ndef props = hostProps.toProperties()\nint timeout = 10000 // 10 sec timeout.\n\ndef snmpMapToTable(snmpmap, int wildvalueTerms = 1) {\n    //println(\"Raw result of snmpwalk of ${Oid}:\\n${snmpmap}\\n${\"=\".multiply(80)}\")\n    rows = [:]\n    snmpmap.each {k,v ->\n        splits = k.tokenize(\".\")\n        col = splits.dropRight(wildvalueTerms).join(\".\")\n        wildvalue = splits.takeRight(wildvalueTerms).join(\".\")\n        if (!(rows.containsKey(wildvalue))) { rows[wildvalue] = [:] }\n        rows[wildvalue][col] = v\n    }\n    return rows\n}\n\nwalkResult = Snmp.walkAsMap(host, Oid, props, timeout)\nentryRaw = snmpMapToTable(walkResult, wildvalueTerms)\n\nadminUpPortCount = 0\nadminDownPortCount = 0\noperUpPortCount = 0\noperDownPortCount = 0\nupup = 0\nupdown = 0\ndownup = 0\ndowndown = 0\n\n\nentryRaw.each {k,v->\n  // println(\"${k}: ${v[\"7\"]} - ${v[\"8\"]}\")\n  admin = v[\"7\"]\n  oper = v[\"8\"]\n\n  if (admin == \"1\") {adminUpPortCount += 1}\n  else {adminDownPortCount += 0}\n\n  if (oper == \"1\") {operUpPortCount +=1}\n  else {operDownPortCount += 1}\n\n  if (admin == \"1\") {\n    if (oper == \"1\") {upup += 1}\n    else {updown += 1}\n  } else {\n    if (oper == \"1\") {downup += 1}\n    else {downdown += 1}\n  }\n}\n\nprintln(\"adminUpPortCount: ${adminUpPortCount}\")\nprintln(\"adminDownPortCount: ${adminDownPortCount}\")\nprintln(\"operUpPortCount: ${operUpPortCount}\")\nprintln(\"operDownPortCount: ${operDownPortCount}\")\nprintln(\"totalPortCount: ${entryRaw.size()}\")\nprintln(\"upup: ${upup}\")\nprintln(\"updown: ${updown}\")\nprintln(\"downup: ${downup}\")\nprintln(\"downdown: ${downdown}\")\n\nreturn 0",
    "scriptType" : "embed",
    "windowsCmdline" : "",
    "windowsScript" : ""
  },
  "enableAutoDiscovery" : false,
  "autoDiscoveryConfig" : null,
  "dataPoints" : [ {
    "id" : 17077,
    "dataSourceId" : 11476338,
    "name" : "adminDownPortCount",
    "description" : "",
    "alertTransitionInterval" : 0,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "namevalue",
    "postProcessorParam" : "adminDownPortCount",
    "rawDataFieldName" : "output",
    "maxValue" : "",
    "minValue" : "",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  }, {
    "id" : 17078,
    "dataSourceId" : 11476338,
    "name" : "adminUpPortCount",
    "description" : "Counts the number of ports where the admin status is equal to 1 (up)",
    "alertTransitionInterval" : 0,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "namevalue",
    "postProcessorParam" : "adminUpPortCount",
    "rawDataFieldName" : "output",
    "maxValue" : "",
    "minValue" : "",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  }, {
    "id" : 17079,
    "dataSourceId" : 11476338,
    "name" : "operDownPortCount",
    "description" : "",
    "alertTransitionInterval" : 0,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "namevalue",
    "postProcessorParam" : "operDownPortCount",
    "rawDataFieldName" : "output",
    "maxValue" : "",
    "minValue" : "",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  }, {
    "id" : 17080,
    "dataSourceId" : 11476338,
    "name" : "operUpPortCount",
    "description" : "",
    "alertTransitionInterval" : 0,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "namevalue",
    "postProcessorParam" : "operUpPortCount",
    "rawDataFieldName" : "output",
    "maxValue" : "",
    "minValue" : "",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  }, {
    "id" : 17081,
    "dataSourceId" : 11476338,
    "name" : "totalPortCount",
    "description" : "",
    "alertTransitionInterval" : 0,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "namevalue",
    "postProcessorParam" : "totalPortCount",
    "rawDataFieldName" : "output",
    "maxValue" : "",
    "minValue" : "",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  }, {
    "id" : 17082,
    "dataSourceId" : 11476338,
    "name" : "portAdminCapacity",
    "description" : "",
    "alertTransitionInterval" : 0,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "expression",
    "postProcessorParam" : "adminUpPortCount / totalPortCount * 100",
    "rawDataFieldName" : "",
    "maxValue" : "",
    "minValue" : "",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  }, {
    "id" : 17083,
    "dataSourceId" : 11476338,
    "name" : "portOperCapacity",
    "description" : "",
    "alertTransitionInterval" : 0,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "expression",
    "postProcessorParam" : "operUpPortCount / totalPortCount * 100",
    "rawDataFieldName" : "",
    "maxValue" : "",
    "minValue" : "",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  }, {
    "id" : 17084,
    "dataSourceId" : 11476338,
    "name" : "downdown",
    "description" : "",
    "alertTransitionInterval" : 0,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "namevalue",
    "postProcessorParam" : "downdown",
    "rawDataFieldName" : "output",
    "maxValue" : "",
    "minValue" : "",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  }, {
    "id" : 17085,
    "dataSourceId" : 11476338,
    "name" : "downup",
    "description" : "",
    "alertTransitionInterval" : 0,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "namevalue",
    "postProcessorParam" : "downup",
    "rawDataFieldName" : "output",
    "maxValue" : "",
    "minValue" : "",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  }, {
    "id" : 17086,
    "dataSourceId" : 11476338,
    "name" : "updown",
    "description" : "",
    "alertTransitionInterval" : 0,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "namevalue",
    "postProcessorParam" : "updown",
    "rawDataFieldName" : "output",
    "maxValue" : "",
    "minValue" : "",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  }, {
    "id" : 17087,
    "dataSourceId" : 11476338,
    "name" : "upup",
    "description" : "",
    "alertTransitionInterval" : 0,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "namevalue",
    "postProcessorParam" : "upup",
    "rawDataFieldName" : "output",
    "maxValue" : "",
    "minValue" : "",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  }, {
    "id" : 17088,
    "dataSourceId" : 11476338,
    "name" : "portCapacity",
    "description" : "",
    "alertTransitionInterval" : 0,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "expression",
    "postProcessorParam" : "upup / totalPortCount * 100",
    "rawDataFieldName" : "",
    "maxValue" : "",
    "minValue" : "",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  } ],
  "enableEriDiscovery" : false,
  "eriDiscoveryInterval" : -1,
  "eriDiscoveryConfig" : null
}